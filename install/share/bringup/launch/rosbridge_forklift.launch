<?xml version="1.0"?>
<launch>
    <node name="rosbridge_plc" pkg="rosbridge_driver" type="rosbridge_driver" output="screen">
        <rosparam>
            port_chain:
              - name: plc
                type: serial
                serial_port: /dev/usb_right
                serial_baud: 115200
                serial_stop: 1
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x10, 0x00, 0x64, 0x00, 0x01, 0x02, 0xcf, 0xfd, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x10, 0x00, 0x64, 0x00, 0x01, crc16, little]
            topic_chain:
              - name: cmd_vel
                type: subscribe
                wheel_model: acke
                fork_a: 4.0 #2.296(v)/0.555(m/s)
                fork_b: 4.1
                plc_a: 3125.0 #3149.2
                plc_b: 0.0903
                stop_mode: move_stop
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x10, 0x00, 0x64, 0x00, 0x09, 0x12, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, speed_plc, big, angle_left, big, angle_right, big, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x64, 0x00, 0x09, crc16, little]
              - name: waypoint_user_pub
                type: subscribe
              - name: move_enable
                type: event
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x06, 0x00, 0x02, 0x04, 0x00, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x02, 0x04, 0x00, crc16, little]
              - name: move_stop
                type: event
                speed_0: 13926
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x06, 0x00, 0x07, speed_0, big, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x07, speed_00, big, crc16, little]
                  - name: plc
                    type: write
                    byte: [0x06, 0x06, 0x00, 0x02, 0x00, 0x00, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x02, 0x00, 0x00, crc16, little]
              - name: move_disable
                type: event
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x06, 0x00, 0x02, 0x00, 0x00, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x02, 0x00, 0x00, crc16, little]
              - name: move_forward
                type: event
                speed_1: 7830
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x06, 0x00, 0x07, speed_1, big, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x07, speed_11, big, crc16, little]
              - name: move_backward
                type: event
                speed_2: 18250
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x06, 0x00, 0x07, speed_2, big, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x07, speed_22, big, crc16, little]
              - name: steer_1
                type: event
                angle_1: 18250
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x06, 0x00, 0x0c, angle_1, big, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x0c, angle_11, big, crc16, little]
              - name: steer_2
                type: event
                angle_2: 9830
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x06, 0x00, 0x11, angle_2, big, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x11, angle_22, big, crc16, little]
              - name: steer_pwm
                type: event
                angle: 125
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x10, 0x00, 0x15, 0x00, 0x03, 0x06, 0x01, 0x00, 0x00, 0xfa, angle, big, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x10, 0x00, 0x15, 0x00, 0x03, crc16, little]
              - name: steer_left
                type: event
                angle: 125
                angle_111: 23588
                angle_222: 2533
                action_chain:
                  - name: plc
                    type: write
                    byte: [0x06, 0x06, 0x00, 0x11, angle_222, big, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x11, angle_22, big, crc16, little]
                  - name: plc
                    type: write
                    byte: [0x06, 0x06, 0x00, 0x0c, angle_111, big, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x06, 0x00, 0x0c, angle_11, big, crc16, little]
                  - name: plc
                    type: write
                    byte: [0x06, 0x10, 0x00, 0x15, 0x00, 0x03, 0x06, 0x01, 0x00, 0x00, 0xfa, angle, big, crc16, little]
                  - name: plc
                    type: read
                    byte: [0x06, 0x10, 0x00, 0x15, 0x00, 0x03, crc16, little]
              - name: diagnostics
                type: publish
        </rosparam>
    </node>
</launch>
